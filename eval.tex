\section{Evaluation}
\label{sec:eval}

\subsection{Micro benchmarks}
\label{sec:eval:micro}

\newcommand*\rot{\rotatebox{90}}

\begin{table}
\centering
\begin{tabular}{l |c|c|c|c|c|c }
\toprule
                   & \multicolumn{3}{c}{\textbf{Firefox}}
                   & \multicolumn{3}{c}{\textbf{Chrome}} \\
                   & \rot{vanilla}   &
                     \rot{unlabeled} &
                     \rot{labeled}   &
                     \rot{vanilla}   &
                     \rot{unlabeled} &
                     \rot{labeled}   
\\\midrule%--------------------------------------------------------------------
% cost of labeled postMessage                                        
Iframe ping-pong   &  0.086  &  0.084  &  0.092  &  0.042  &  0.042  &  0.042
\\\hline%----------------------------------------------------------------------
% cost of creating an iframe                                         
New iframe         &   13.27  &  13.3   & 13.97   &   50.63 &   48.73 &  51.77 
\\\hline%----------------------------------------------------------------------
% cost of performing XHR                                             
XHR ping-pong      &  3.33   &   3.48  &  3.49   &  7.0    &  7.4    & 7.2
\\\hline%----------------------------------------------------------------------
% cost of creating a worker                                          
New worker         &  20.53  &   21.24 &  1.62   &  18.94  &  18.87  & 3.27
\\\hline%----------------------------------------------------------------------
% cost of worker ping-pong                                           
Worker ping-pong   &  0.059  &   0.055 &  0.037  &  0.071  &  0.070  & 0.030
\\\hline%----------------------------------------------------------------------
% cost of setting current label                                      
Set label          &  --     &  \multicolumn{2}{c|}{0.0014} &   --   
                             &  \multicolumn{2}{c }{0.0018}
\\\hline%-------------------------------------------------------------------------------------------------
% cost of setting current label                                                                   
Get label          &  --     &  \multicolumn{2}{c|}{0.0003} &   --   
                             &  \multicolumn{2}{c }{0.0008}
\\\hline%-------------------------------------------------------------------------------------------------
% cost of comparing labels                                                                        
Label subsumes     &  --     &  \multicolumn{2}{c|}{0.0012} &   --   
                             &  \multicolumn{2}{c }{0.0004}
\\\bottomrule
\end{tabular}
\caption{\label{microbench} Micro-benchmarks. \todo{ds}{explain each
one}. All measurements are in milliseconds.}
\end{table}

I suspect that the worker ping-pong is faster on Firefox than the iframe
ping-pong because the access control checks between frames passes through
wrapper. While access to worker is direct.
%
In chrome? (Probably the opposite since checks are done in the bindings)
%
Why is iframe creation so slow in chrome?


\subsection{Macro benchmarks}
\label{sec:eval:macro}

\paragraph{Password-strength checker}
%
We measured the time it take to check the strength of a randomly generated
16-character password.
%

Vanilla: just run script in worker

Firefox: With \sys{} it take 59.5ms, Vanilla: 61.4
Chome: With \sys{} it take 80.5ms, Vanilla:  71.5


\paragraph{Encrypted cloud-based editor}
%
we measured the time it takes to save an encrypted a document
\Red{XXX}-character document.

Vanilla: removed the sandbox stuff.

Firefox: With \sys{} it take 114.8s, Vanilla: 100.2
Chome: With \sys{} it take 248.1, Vanilla; 257.8s

\paragraph{Third-party mashup}

We measured the time it takes to perform requests to two different origins,
which return a simple \Red{XXX}-JSON object, including a number.
%
Our mashup benchmark simply adds the numbers.


Firefox: With \sys{} it take 10.7ms, Vanilla:  10.7ms
Chrome: With \sys{} it take 15ms, Vanilla:  17ms

Vanilla: just remove sandbox stuff + add CORS

\paragraph{Phone2Links}

We measure the load time of a bank page incorporating the Phone2Links library;
in the first case, the bank trusted code is placed a LWorker, following the
pattern of Section~\ref{sec:system:script}; in the second case, the untrusted
code is treated like an extension and placed in an LWorker with no privileges,
following the pattern of Section~\ref{sec;system:extension}.

Vanilla: incorporate script directly, no sandboxes.


As page confine:
Firefox: With \sys{} it take 164.8ms, Vanilla:  160.2ms

As extension
Firefox: With \sys{} it take 224.4ms
