\section{Related Work}
\label{sec:related}

% BFlow
The closest related work to our system is BFlow~\cite{Yip:2009:PBS}.
%
Like \sys{}, BFlow allows websites to enforce confinement policies
that are stricter than the SOP\@.
%
BFlow can, for example, be used to confine third-party code by placing
the untrusted code in a tainted \emph{protection zone}, which is a group
of iframes that share a common label.
%
However, unlike \sys{}, BFlow cannot be used to mediate between mutually
distrustful applications: for example, the encrypted document editor
cannot be directly implemented.
%
This is because BFlow solely provides hierarchical confinement---a
sub-frame cannot impose any restrictions on its parent---and its
labels are very restricting (e.g., BFlow cannot encode a policy that
states that data may be sensitive to two websites).\footnote{
The mutually distrusting scenario is further complicated by BFlow's
reliance on top-level \emph{trusted zones} that can always
\emph{completely} declassify the data in their corresponding page.}
%
This also prevents BFlow from being amendable to building
applications, such as our third-party mashup, that rely on security policies
more flexible than the SOP\@.
%
In fairness, BFlow did not consider applications with mutually
distrusting parties---their goal was to confine untrusted third-party
scripts, and they indeed succeed at doing so.
%
While \sys{} propagates labels using HTTP headers and is
amendable to confining one user's code from another on the same
website, unlike BFlow, we did not develop a server that implements this
functionality; developers can use BFlow's server or systems such as
Hails~\cite{giffin:2012:hails} and Aeolus~\cite{cheng:aeolus} to
ensure that labels are propagated appropriately in an end-to-end
fashion.
%
%%I think the story might be even better for us: I don't think they
%%can build password checker where the latter is an iframe hosted on
%%other domain.
%%
%%Waiting on email

%% BFlow~\cite{Yip:2009:PBS} is a confinement system for web browsers. It tracks
%% flows of information at the granularity of \emph{secure zones}, i.e.,
%% compartments composed of one or several iframes.  {\sys} does not require such
%% abstraction, it relies on the compartment notions already provided by browsers,
%% i.e., iframes and workers. Similar to our approach, BFlow uses \js|postMessage|
%% for communication across secure zones. BFlow does not allow JavaScript code in
%% different secure zones to write to shared DOM variables and cookies regardless
%% their security labels.  While \sys~ supports more expressive labels, potentially
%% including different domains, BFlow can propagates labeled data to the server
%% side. It is stated as future work to achieve a similar feature.


% DCS 
More recently, Akhawe \emph{et al.} proposed the data-confined
sandbox (DCS) system~\cite{Akhawe2013}, which provides pages with the
ability to intercept and monitor the network, storage and cross-origin
channels of certain iframes.
%
This, in turn, can be used used to confine code such as the password
strength checker.
%
Unfortunately, their confinement is fundamentally limited to 
\verb|data:| URI iframes, and, as a result, DCS cannot confine a
password strength checker service for which the source is not
available (e.g., if provided by an iframe).
%
Like BFlow, DCS only enforces hierarchical confinement---an iframe
cannot impose restrictions on its parent.
%
In fairness, this asymmetry is due to their more modest goal of
confining untrusted libraries.
%
Unlike \sys{}, DCS is not limited to using labels for policy
specification; instead, it allows a page to implement policies using
arbitrary JavaScript.
%
However, to ensure that the monitor cannot be used to learn more
information about the iframe content than allowed by the SOP, the
kinds of policies that a page can impose on an iframe is limited
(e.g., DCS cannot impose restrictions on redirects).
%
\sys{} does not have this limitation since the iframe itself imposes
the policy (it voluntarily raises its label).
%
This design choice of using declarative policies further allows us to
relax the SOP and build applications such as the third-party mashup.
%
\Red{What is the limitation} However, we recognize this as a limitation of \sys{} and leave the
investigation of expressiveness labels to future work.

%% Recently, and different from other sandboxes approaches, the
%% data-confined sandbox system~\cite{Akhawe2013} (DCS) restricts
%% propagation of information by using \js|iframes| and mediating
%% cross-domain operations (e.g. access to local storage, fragment-IDs,
%% network communication, etc.).  Every sandbox communicates by
%% \js!postMessage! only with its designated parent. The parent defines
%% the confinement policy and plays the role of man-in-the-middle when a
%% sandbox wish to communicate with another one. While having similar
%% goals, DCS is more restrictive than \sys. DCS disallows dynamic code
%% evaluation inside sandboxes and presents a not egalitarian design,
%% i.e., a sandbox (\js|iframe|) cannot host another sandbox. Clearly,
%% the DCS client-side TCB is smaller than ours.



% JSFlow 
JSFlow~\cite{JSFlow} is a fine-grained IFC system for JavaScript,
implemented in JavaScript.
%
By associating labels with individual objects, JSFlow can be used to
confine untrusted libraries, such as jQuery, which are intertwined with
trusted code on a page.
%
\sys{}, on the other hand, is coarse-grained and, like BFlow, generally
requires the application to be compartmentalized (e.g., by placing the
page code that needs to communicate with the network in a lightweight
DOM worker).
%
While the fine-grained approach has many benefits, there
are also several drawbacks.
%
First, JSFlow cannot be used to confine style sheets that execute code
or build applications that rely on policies more flexible than SOP,
such as third-party mashups \Red{reading cross-origin data by XHR requests.}
%
%%Second, developers need to understand a new semantics for the core
%%JavaScript language~\cite{Hedin:2012}, in contrast to a new DOM-leve
%%API.
%
Second, library APIs, including the JavaScript built-in APIs, must be
individually modeled; though their coverage of the DOM is very commendable.
%
This incurs a huge performance cost (by two orders of magnitude)
and restricts the APIs available to developers.
%
Nevertheless, we find JSFlow mostly complimentary and envision
application where some \sys{} compartments enforce fine-grained IFC by
leveraging JSFlow.


%% Hedin and Sabelfeld~\cite{Hedin:2012} formally describe a sound language-based
%% confinement mechanisms for a subset of JavaScript and their ideas are being
%% currently applied to JSFlow~\cite{JSFlow}. %, a modified JavaScript interpreter.
%% JSFlow is designed to confine legacy code, and because of that, it does an
%% impressive effort to obtain fine-grain labeling of data. This is achieved at the
%% price of proposing detailed models for capturing big parts of the browser
%% semantics (e.g. interaction with the DOM), which drastically impact on
%% performance (sometimes more than 100\%!).  We provide a more coarse-grain
%% approach: \emph{\sys{} does not care for most of the JavaScript and DOM API
%%   internals}. Instead, \sys~ uses the browsing contexts and simply
%% mediates among them to preserve security.


% With our
FlowFox~\cite{DeGroef:2012} is an IFC system that uses secure-multi
execution (SME)~\cite{Devriese:2010} to execute a program multiple
times, once per each label; SME ensures that no leaks from a sensitive
context can leak into a less-senstive context by construction.
%
Similar to JSFlow, FlowFox can confine programs
with fine-grained labeling of data.
%
Different from JSFlow and \sys{}, FlowFox's SME approach is not
amendable to scenarios where declassification plays
a key role (e.g., the encrypted editor, password manager, or
third-party mashup). 
%
\Red{Although SME has been recently extended to consider
  declassification~\cite{Rafnsson:2013}, it is unclear how this theoretical
result translates into FlowFox, and more importantly, how it affects its applicability.}
%
An interesting application of FlowFox is how it labels user interaction and metadata
(history, screen size, etc.) to address common privacy attacks such as
history sniffing and behavior tracking.
%
These attacks are outside the present scope of \sys{} and thus the
degree of protection we provide for such data is limited to the
policies imposed by developers before sharing the data.

%
%% Authors show how FlowFox can enforce
%% non-interference like policies for popular web cites. While \sys{} does not
%% target legacy code, it can enforce a wider-range of policies
%% (e.g. declassification). Different from \sys{}, FlowFox requires a total
%% ordering of the security lattice, an uncommon assumption in an scenario with
%% mutual distrust (as the web). While recent results show how to lift this
%% requirement in reactive systems (as the browser)~\cite{ZanariniJR13}, FlowFox
%% has not yet incorporate them into its design.

% ConDOM 
%\todo{ar}{revise as the above}
%ConDOM~\cite{ConDOM} implements fine-grained label tracking system
%that spans both the JavaScript engine and DOM\@.
%%
%To handle implicit flows, authors use a
%control flow stack (neglecting exceptions) and inject labels at the HTML parser
%for dynamically generated code. In contrast, \sys{} handles any type of
%branches or dynamic code by labeling the browsing context itself. \todo{ezy}{this doesn't seem very convincing\ldots}


%Sandboxing/language subsets
There is much work on sandboxing and developing subsets of JavaScript (e.g.,
Caja~\cite{GoogleCaja}, BrowserShield~\cite{Reis:2007},
WebJail~\cite{VanAcker:2011}, TreeHouse~\cite{Ingram:2012},
JSand~\cite{Agten:2012:JCC}, SafeScript~\cite{SafeScript}, Defensive
JavaScript~\cite{djs}). 
%
While our design has been inspired by some of these systems (e.g., TreeHouse), the
usual goals of these systems are to mediate security
critical operations, restrict access to the DOM, and restrict communication APIs\@.
%
In contrast to the mandatory nature of confinement, however, most restrictions
are imposed in a discretionary fashion and are thus not suitable to the
building a number of the applications we consider (in particular, the encrypted
editor).
%
Nevertheless, we believe that access control and language subsets are a crucial
complement to confinement when building robust secure applications.



%%% Google extensions security analysis 
%%Carlini \emph{et al.}~\cite{Carlini:2012} evaluate the security of the
%%Google Chrome extension platform.
%
\sys{}'s lightweight DOM workers are very similar to content
scripts~\cite{Carlini:2012}, although provided as DOM objects to
website developers.
%
However, as opposed to real extension systems, we do not not consider
privileged APIs, nor do we intend to extend the API made available to
workers in such a way.
%
Instead, we believe that extension systems can stand to benefit from
confining content scripts, if only to provide a means for further
reducing the trust placed on existing extensions.
%
Indeed, since Firefox content scripts rely on the same core mechanisms
used by \sys{}, we expect a port of Add-on SDK to use confinement to
be achievable with only modest effort.
 

% Local Variables:
% TeX-master: "main.ltx"
% TeX-command-master: "make"
% tex-dvi-view-command: "gmake preview;:"
% End:
